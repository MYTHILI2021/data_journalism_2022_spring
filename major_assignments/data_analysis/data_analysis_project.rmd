---
title: "data_analysis_project"
author: "Jon Donville,Varun Shankar, Mythili Devarakonda"
date: "16/04/2022"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

```{r}
library(tidyverse)
library(janitor)
library(tidycensus)
library(stringr)
library(lubridate)
```


## Read in data 

```{r}
marvel_data <- read_csv("data/marvel-wikia-data.csv")
dc_data <- read_csv("data/dc-wikia-data.csv")
```

## Exploratory analysis

1) Marvel Data

The marvel_data dataset consists of 16,376 rows and 13 columns of data on Marvel comic characters. In such a large dataset, only about 90 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}
glimpse(marvel_data)
marvel_data_lgbt <- marvel_data %>% 
  filter (! is.na (GSM)) %>% 
  clean_names()
marvel_data_no_lgbt <- marvel_data %>% 
  filter (is.na (GSM)) %>% 
  clean_names()
```

2) DC Data

The dc_data dataset consists of 6,896 rows and 13 columns of data on DC comic characters. In such a large dataset, only about 64 comic characters are known to be a "gender or sexual minority", according to the data.

``` {r}
glimpse(dc_data)
dc_data_lgbt <-dc_data %>% 
  filter (! is.na (GSM)) %>% 
    clean_names()
dc_data_no_lgbt <-dc_data %>% 
  filter (is.na (GSM)) %>% 
    clean_names()
total_lgbt <- rbind(dc_data_lgbt, marvel_data_lgbt)
total_non_lgbt <- rbind(dc_data_no_lgbt, marvel_data_no_lgbt)
```

```{r}
# Create an if/else statement to create new columns that group characters into LGBT or not, and neutral color hair or not.
dc_data_lgbt_hair <- dc_data_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        hair == 'Black Hair' ~ "NEUTRAL",
        hair == 'Blond Hair' ~ "NEUTRAL",
        hair == 'Brown Hair' ~ "NEUTRAL",
        hair == 'Auburn Hair' ~ "NEUTRAL", 
        hair == 'Bald' ~ "NEUTRAL",
        hair == 'Green Hair' ~ "Not",
        hair == 'Blue Hair' ~ "Not",
        hair == 'Gold Hair' ~ "Not", 
        hair == 'Grey Hair' ~ "NEUTRAL",
        hair == 'Orange Hair' ~ "Not",
        hair == 'Pink Hair' ~ "Not",
        hair == 'Platinum Blond Hair' ~ "NEUTRAL", 
        hair == 'Purple Hair' ~ "Not",
        hair == 'Red Hair' ~ "Not",
        hair == 'Reddish Brown Hair' ~ "NEUTRAL",
        hair == 'Silver Hair' ~ "Not", 
        hair == 'Strawberry Blond Hair' ~ "NEUTRAL",
        hair == 'Violet Hair' ~ "Not",
        hair == 'White Hair' ~ "Not",
        
      )
  ) 
marvel_data_lgbt_hair <- marvel_data_lgbt %>% 
  mutate(
    neutral_hair_or_not = case_when(
        hair == 'Black Hair' ~ "NEUTRAL",
        hair == 'Blond Hair' ~ "NEUTRAL",
        hair == 'Brown Hair' ~ "NEUTRAL",
        hair == 'Auburn Hair' ~ "NEUTRAL", 
        hair == 'Bald' ~ "NEUTRAL",
        hair == 'Green Hair' ~ "Not",
        hair == 'Blue Hair' ~ "Not",
        hair == 'Gold Hair' ~ "Not", 
        hair == 'Grey Hair' ~ "NEUTRAL",
        hair == 'Orange Hair' ~ "Not",
        hair == 'Pink Hair' ~ "Not",
        hair == 'Platinum Blond Hair' ~ "NEUTRAL", 
        hair == 'Purple Hair' ~ "Not",
        hair == 'Red Hair' ~ "Not",
        hair == 'Reddish Brown Hair' ~ "NEUTRAL",
        hair == 'Silver Hair' ~ "Not", 
        hair == 'Strawberry Blond Hair' ~ "NEUTRAL",
        hair == 'Violet Hair' ~ "Not",
        hair == 'White Hair' ~ "Not",
        
      )
  ) 
```
Question 1: What percentage of LGBT comic characters get more than 1 appearance and average appearances?

```{r}
lgbt_dc_characters_overoneapp <- dc_data_lgbt %>% 
    filter(APPEARANCES > 1)
lgbt_marvel_characters_overoneapp <- marvel_data_lgbt %>% 
    filter(APPEARANCES > 1)
 dclgbtcount = count(dc_data_lgbt)
 dclgbtcountoveroneapp = count(lgbt_dc_characters_overoneapp)
 marvellgbtcount = count(lgbt_marvel_characters)
 marvellgbtcountoveroneapp = count(marvel_data_lgbt)
 
 
 ((dclgbtcountoveroneapp+marvellgbtcountoveroneapp)/(marvellgbtcount+dclgbtcount))*100
 
 
             
```

Question 2: What's the alignment of LGBT comic characters?

```{r}
dc_lgbt_heroes <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")
marvel_lgbt_heroes <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIGN == "Good Characters")
dclgbtcountgoodguy = count(dc_lgbt_heroes)
marvellgbtcountgoodguy = count(marvel_lgbt_heroes)
 dclgbtcount = count(lgbt_dc_characters)
 marvellgbtcount = count(lgbt_marvel_characters)
 
  ((dclgbtcountgoodguy+marvellgbtcountgoodguy)/(marvellgbtcount+dclgbtcount))*100
```

Question 3: What's the identity status of LGBT characters? (Here: Identity means secret or public or dual identity according to the data)

Answer: Half of the LGBT characters in the given data have a secret identity while only 37.2% of non-LGBT characters have a secret identity.This question looks at whether LGBT characters have to hide their orientation or not. With so many LGBT individuals struggling with coming out in terms of their gender identity, this is one of our most fascinating questions which will impact greatly the role that these characters have in the comic world. 

```{r}
lgbt_secret <- total_lgbt %>% 
  filter(id == "Secret Identity") 

secret_lgbt_count = count(lgbt_secret)
 lgbt_count = count(total_lgbt)
 
  #percentage of lgbt individuals with secret identities
 
 (secret_lgbt_count/lgbt_count)*100
 
 non_lgbt_secret <- total_non_lgbt %>% 
  filter(id == "Secret Identity") 
 
 secret_non_lgbt_count = count(non_lgbt_secret)
 non_lgbt_count = count(total_non_lgbt)
 
 #percentage of non-lgbt individuals with secret identities
 (secret_non_lgbt_count/non_lgbt_count)*100
 
```

Question 4: Whatâ€™s the death rate of LGBT comic characters ?

```{r}
dc_lgbt_alive <- dc_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")
marvel_lgbt_alive <- marvel_data_lgbt_hair %>% 
  filter(lgbt_or_not == "LGBT" & ALIVE == "Living Characters")
dclgbtcountalive= count(dc_lgbt_alive)
marvellgbtcountalive = count(marvel_lgbt_alive)
((dclgbtcountalive+marvellgbtcountalive)/(marvellgbtcount+dclgbtcount))*100
```

Question 5: What percentage of LGBT characters have neutral hair colors? 
```{r}
neutral_marvel_data_lgbt_hair    <-marvel_data_lgbt_hair %>% 
  filter(neutral_hair_or_not == "NEUTRAL")  
neutral_dc_data_lgbt_hair    <-dc_data_lgbt_hair %>% 
  filter(neutral_hair_or_not == "NEUTRAL")  
marvelneutralhaircount = count(neutral_marvel_data_lgbt_hair)
dcneutralhaircount = count(neutral_dc_data_lgbt_hair)
(marvelneutralhaircount+dcneutralhaircount)/(marvellgbtcount+dclgbtcount)
``` 

